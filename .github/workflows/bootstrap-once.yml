name: Bootstrap automático (uma vez)

on:
  push:
    branches: [main]

permissions:
  contents: write

jobs:
  bootstrap:
    if: ${{ !exists('textos') }}   # só roda se /textos não existir
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Criar estrutura mínima
        run: |
          mkdir -p textos/exemplo/{insights,referencias,assets}
          echo "# Exemplo de texto (Memotopia)" > textos/exemplo/index.md
          echo "- Insight inicial" > textos/exemplo/insights/01-primeiro-insight.md
          printf "voz: reflexiva\nritmo: calmo\nmetaforas: 'oficina, jardim, sistema vivo'\n" > textos/exemplo/estilo.yml
          echo "# Memotopia" > README.md
      - name: Commit
        run: |
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add -A
          git commit -m "bootstrap: cria estrutura mínima automaticamente" || true
          git push || true
